<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://unpkg.com/vue@2.5.17/dist/vue.js"></script>
    <title>MyTV</title>
  </head>
  <body>
  <h1>Now Playing</h1>
  <div class="container">
    <video id="video" controls></video>
  </div>
  <div class="container">
    <div id="newrel1" class="row">
      <div class="col-md-4">
        <div class="card" style="width: 18rem;">
          <img class="card-img-top" v-bind:src="poster" alt="">
          <div class="card-body">
            <h5 class="card-title">{{title}}</h5>
            <p class="card-text">{{description}}</p>
            <button v-on:click="loadPlayer" >Play</button>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card" style="width: 18rem;">
          <img class="card-img-top" v-bind:src="poster" alt="">
          <div class="card-body">
            <h5 class="card-title">{{title}}</h5>
            <p class="card-text">{{description}}</p>
            <button v-on:click="loadPlayer" >Play</button>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card" style="width: 18rem;">
          <img class="card-img-top" v-bind:src="poster" alt="">
          <div class="card-body">
            <h5 class="card-title">{{title}}</h5>
            <p class="card-text">{{description}}</p>
            <button v-on:click="loadPlayer" >Play</button>
          </div>
        </div>
      </div>
    </div>
  </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/ipfs/dist/index.js"></script>
    <script src="https://unpkg.com/hlsjs-ipfs-loader@0.1.2/dist/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script type="text/javascript">
    const repoPath = 'ipfs-' + Math.random();
    const node = new Ipfs({ repo: repoPath });
    var vm = new Vue({
      el: "#newrel1",
      data: {
        poster:"./img/last_samurai_ver3.jpg",
        title:"The Last Samurai",
        description:"Capt. Nathan Algren (Tom Cruise) is an American military officer hired by the Emperor of Japan to train the country's first army in the art of modern warfare. As the government attempts to eradicate the ancient Samurai warrior class in preparation for more Westernized and trade-friendly policies, Algren finds himself unexpectedly affected by his encounters with the Samurai, which places him at the center of a struggle between two eras and two worlds.",
        hash:"QmPXZNJQYEhrx84piEjGDqnJFxu7u9bUK6rqZ5jH4rZ5tZ"
      },
      methods:{
        loadPlayer: function(){
          Hls.DefaultConfig.loader = HlsjsIpfsLoader;
          Hls.DefaultConfig.debug = false;
          if (Hls.isSupported()) {
            const video = document.getElementById('video');
            const hls = new Hls();
            hls.config.ipfs = node;
            hls.config.ipfsHash = "QmPXZNJQYEhrx84piEjGDqnJFxu7u9bUK6rqZ5jH4rZ5tZ";
            hls.loadSource('master.m3u8');
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
          }
        }
      }
    });
    </script>
  </body>
</html>
